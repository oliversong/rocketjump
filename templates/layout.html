<!doctype html>
<html class="no-js" lang="en">
    <head>
        <meta charset="utf-8">

        <title>Rocketjump | {% block title %}{% endblock %}</title>

        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="description" content="Entry for 6.470 2013.">
        <meta name="author" content="Oliver Song">
        <link rel="shortcut icon" href="/static/favicon.ico">

        <link rel=stylesheet type=text/css href="/static/css/style.css">
        <link rel=stylesheet type=text/css href="/static/css/bootstrap.css">
        <link rel=stylesheet type=text/css href="/static/css/bootstrap-responsive.css">


        <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
        <!--[if lt IE 9]>
              <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->

        <!-- <script src="/static/js/modernizr.js"></script> -->

    </head>

    <body>

        <div id="fb-root"></div>
        <script>
            // Additional JS functions here
            window.fbAsyncInit = function() {
                FB.init({
                    appId      : '124499577716801', // App ID
                    channelUrl : '//rocketjump.herokuapp.com//channel.html', // Channel File
                    status     : true, // check login status
                    cookie     : true, // enable cookies to allow the server to access the session
                    xfbml      : true  // parse XFBML
                });

                // Additional init code here

                FB.getLoginStatus(function(response) {
                    if (response.status === 'connected') {
                        // connected. Show their facebook profile picture and link to their user page
                        console.log("connected facebook account detected")
                        // userID should be in session
                        //response.authResponse['userID']
                    } else if (response.status === 'not_authorized') {
                        // not_authorized. Show login button
                        $('#loginButton').click(function(){
                            console.log("attempting to do the login")
                            login();
                        });
                    } else {
                        // not_logged_in. Show login button
                        $('#loginButton').click(function(){
                            console.log("attempting to do the login")
                            login();
                        });
                    }
                });
            };

            function login() {
                FB.login(function(response) {
                    if (response.authResponse) {
                        // connected
                    } else {
                        // cancelled
                    }   
                });
            }

            // Load the SDK Asynchronously
            (function(d){
                var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
                if (d.getElementById(id)) {return;}
                js = d.createElement('script'); js.id = id; js.async = true;
                js.src = "//connect.facebook.net/en_US/all.js";
                ref.parentNode.insertBefore(js, ref);
            }(document));
        </script>

        <header>
            {% include "header.html" %}
            <hr>
        </header>

        <div class="container">
            
            {% for message in get_flashed_messages() %}
                <div class="flash span12">{{ message }}</div>
            {% endfor %}

            {% block body %}{% endblock %}

        </div>

        <footer>
            <hr>
            {% include "footer.html" %}
        </footer>

        <script src="http://code.jquery.com/jquery-latest.js"></script>
        <script src="{{ url_for('static', filename='js/bootstrap.min.js') }}"></script>
        <script src="{{ url_for('static', filename='js/app.js') }}"></script>

        <script type="text/javascript">

          var _gaq = _gaq || [];
          _gaq.push(['_setAccount', 'UA-37449741-1']);
          _gaq.push(['_trackPageview']);

          (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
          })();

        </script>


    </body>
</html>
